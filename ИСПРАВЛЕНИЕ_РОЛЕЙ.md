# Исправление ошибки с ролями пользователей

## Проблема
При выполнении SQL миграций возникала ошибка:
```
ERROR: 22P02: invalid input value for enum user_role_enum: "admin"
```

## Причина
В базе данных используется enum `user_role_enum` со следующими значениями:
- `administrator` (не `admin`)
- `moderator` 
- `trainer`
- `employee`
- `expert`

## Исправления внесены в файлы:
1. `create_project_defense_evaluations.sql`
2. `create_diagnostic_game_evaluations.sql`

## Изменения
Заменены все вхождения:
```sql
-- БЫЛО:
AND role IN ('admin', 'expert', 'trainer')

-- СТАЛО:
AND role IN ('administrator'::user_role_enum, 'moderator'::user_role_enum, 'expert'::user_role_enum, 'trainer'::user_role_enum)
```

## Дополнительные исправления
Добавлены `DROP POLICY IF EXISTS` команды для предотвращения ошибок при повторном выполнении:
```sql
-- Удаляем существующие политики если они есть
DROP POLICY IF EXISTS "Users can view project defense evaluations" ON public.project_defense_evaluations;
DROP POLICY IF EXISTS "Experts can insert project defense evaluations" ON public.project_defense_evaluations;
-- ... и так далее
```

## Применение исправлений
Теперь SQL миграции можно выполнить без ошибок (в том числе повторно):

```bash
# Для защиты проектов
psql -h your-db-host -U your-username -d your-database -f create_project_defense_evaluations.sql

# Для диагностической игры  
psql -h your-db-host -U your-username -d your-database -f create_diagnostic_game_evaluations.sql
```

Или через Supabase Dashboard SQL Editor.

## Роли с правами эксперта
Пользователи со следующими ролями могут создавать/изменять оценки:
- `administrator` - полные административные права
- `moderator` - модераторские права  
- `expert` - роль эксперта для оценки
- `trainer` - роль тренера

Роль `employee` (обычный сотрудник) может только просматривать свои оценки.
