# Тестирование QR-кода авторизации

## Быстрый тест

1. **Откройте браузер** и перейдите по адресу: `http://localhost:5173/test-qr`

2. **Нажмите кнопку** "Генерировать QR-код для max22@max.ru"

3. **Отсканируйте QR-код** камерой телефона или используйте кнопку "Ссылка" для копирования

4. **Перейдите по ссылке** - должна произойти автоматическая авторизация

## Ожидаемое поведение

### ✅ Успешная авторизация:
- QR-код генерируется без ошибок
- При переходе по ссылке открывается страница `/auth/callback`
- Показывается сообщение "Авторизация успешна! Перенаправление..."
- Через 2 секунды происходит перенаправление на главную страницу `/`
- Пользователь авторизован в системе

### ❌ Возможные проблемы:

1. **Ошибка 500 при генерации QR-кода**
   - Проверьте логи Edge Function в Supabase Dashboard
   - Убедитесь, что Edge Function развернута

2. **QR-код генерируется, но авторизация не работает**
   - Проверьте консоль браузера на ошибки
   - Убедитесь, что пользователь `max22@max.ru` существует в базе данных

3. **Ссылка не открывается**
   - Проверьте, что `PUBLIC_APP_URL` правильно настроен в переменных окружения

## Отладка

### Консоль браузера
Откройте DevTools (F12) и проверьте сообщения в консоли:

```
QR generation response: {actionLink: "...", expiresAt: "..."}
Generating QR code for: https://...
QR code generated successfully
```

### Логи Edge Function
В Supabase Dashboard → Functions → generate-qr-login → Logs:

```
Generated magic link for: max22@max.ru
Action link: https://...
```

## Тестовые данные

- **Email**: max22@max.ru
- **Пароль**: 123456
- **Роль**: employee

## Альтернативный тест

Если QR-код не работает, можно протестировать обычную авторизацию:

1. Перейдите на `http://localhost:5173/login`
2. Введите `max22@max.ru` и пароль `123456`
3. Проверьте, что авторизация работает
