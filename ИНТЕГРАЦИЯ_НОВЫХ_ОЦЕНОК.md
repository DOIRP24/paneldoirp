# Интеграция новых типов оценки в ExpertExamPage

## Проблема
После создания новых модальных окон `ProjectDefenseModal` и `DiagnosticGameModal`, кнопки "Защита проекта" и "Диагностическая игра" в `ExpertExamPage` не работали.

## Решение
Интегрированы новые модальные окна в `ExpertExamPage.tsx`:

### 1. Добавлены импорты
```typescript
import { ProjectDefenseModal } from './ProjectDefenseModal';
import { DiagnosticGameModal } from './DiagnosticGameModal';
```

### 2. Добавлены состояния для модальных окон
```typescript
const [showProjectDefenseModal, setShowProjectDefenseModal] = useState(false);
const [showDiagnosticGameModal, setShowDiagnosticGameModal] = useState(false);
```

### 3. Обновлен обработчик выбора этапа
```typescript
onStageSelect={(stage, caseNumber) => {
  console.log('Selected stage:', stage, 'case number:', caseNumber, 'for participant:', selectedParticipantForEvaluation?.user.full_name);
  
  // Для кейсов НЕ закрываем основное меню (обрабатывается внутри EvaluationStageModal)
  // Для других этапов закрываем и переходим к соответствующему модальному окну
  if (stage !== 'case-solving') {
    setShowEvaluationModal(false);
    console.log('Переход к оценке этапа:', stage);
    
    // Открываем соответствующее модальное окно
    if (stage === 'project-defense') {
      setShowProjectDefenseModal(true);
    } else if (stage === 'diagnostic-game') {
      setShowDiagnosticGameModal(true);
    }
  }
}}
```

### 4. Добавлены модальные окна в JSX
```typescript
{/* Модальное окно защиты проекта */}
{selectedParticipantForEvaluation && (
  <ProjectDefenseModal
    isOpen={showProjectDefenseModal}
    onClose={() => {
      setShowProjectDefenseModal(false);
      setSelectedParticipantForEvaluation(null);
    }}
    participantId={selectedParticipantForEvaluation.user.id}
    participantName={selectedParticipantForEvaluation.user.full_name}
    examId={id || ''}
    onEvaluationComplete={async () => {
      await fetchExamData(); // Перезагружаем данные
    }}
    onRemoveEvaluation={async (participantId) => {
      await fetchExamData(); // Перезагружаем данные
    }}
  />
)}

{/* Модальное окно диагностической игры */}
{selectedParticipantForEvaluation && (
  <DiagnosticGameModal
    isOpen={showDiagnosticGameModal}
    onClose={() => {
      setShowDiagnosticGameModal(false);
      setSelectedParticipantForEvaluation(null);
    }}
    participantId={selectedParticipantForEvaluation.user.id}
    participantName={selectedParticipantForEvaluation.user.full_name}
    examId={id || ''}
    onEvaluationComplete={async () => {
      await fetchExamData(); // Перезагружаем данные
    }}
    onRemoveEvaluation={async (participantId) => {
      await fetchExamData(); // Перезагружаем данные
    }}
  />
)}
```

## Результат
Теперь при нажатии на:
- **"Защита проекта"** - открывается модальное окно `ProjectDefenseModal`
- **"Диагностическая игра"** - открывается модальное окно `DiagnosticGameModal`

## Workflow
1. Пользователь нажимает "Поставить оценку" на карточке участника
2. Открывается `EvaluationStageModal` с выбором этапа
3. При выборе "Защита проекта" или "Диагностическая игра" закрывается меню выбора этапа и открывается соответствующее модальное окно оценки
4. После завершения оценки данные автоматически перезагружаются

## Файлы изменены
- `src/components/exam/ExpertExamPage.tsx` - добавлена интеграция новых модальных окон

## Тестирование
После применения изменений проверьте:
1. Нажатие на кнопку "Поставить оценку" открывает меню выбора этапа
2. Нажатие на "Защита проекта" открывает соответствующее модальное окно
3. Нажатие на "Диагностическая игра" открывает соответствующее модальное окно
4. Сохранение оценок работает корректно
5. После сохранения оценки данные обновляются
